<p>Welcome to your new game</p>

<h4>Players:</h4>
<ul>
  <% @state.players.each do |player| %>
    <li><%= 'Your turn: ' if player == @state.current_player %><%= player %></li>
  <% end %>
</ul>

<% if @player %>
  <h3><%= @player.name %></h3>
  <div class="hand">
    <% @player.hand.each do |card| %>
      <div class="card <%= card.color %>"><%= card.color %></div>
    <% end %>
  </div>

  <%= form_tag("/games/#{@game.id}/actions/create") do %>
    <%= hidden_field_tag(:action_type, 'draw_route_cards') %>
    <%= submit_tag('Draw Route Cards') %>
  <% end %>

  <%= form_tag("/games/#{@game.id}/actions/create") do %>
    <%= hidden_field_tag(:action_type, 'keep_route_cards') %>
    <% @player.potential_routes.each do |route_card| %>
      <%= check_box_tag 'route_cards_to_keep[]' %>
      <div class="card route-card">Route: <%= route_card %></div>
    <% end %>

    <%= submit_tag('Keep Route Cards') %>
  <% end -%>

<% end %>

<div class="links">
  <svg
    width="600"
    height="400">

    <% @state.links.each do |link| %>
      <line x1="<%= link.city_a.x %>" y1="<%= link.city_a.y%>"
      x2="<%= link.city_b.x %>" y2="<%= link.city_b.y%>"
      stroke="<%= link.color %>" stroke-width="6" class="link"/>
    <% end %>

    <% @state.cities.each do |city| %>
      <circle cx="<%= city.x %>" cy="<%= city.y %>" r="50" fill="gray" />
      <text x="<%= city.x %>" y="<%= city.y %>"
        text-anchor="middle">
        <%= city.name %>
        </text>
    <% end %>
  </svg>
</div>

<div class="cards">
  <% @state.available_train_cards.each_with_index do |train_card, index| %>
    <%= form_tag("/games/#{@game.id}/actions/create") do %>
      <%= hidden_field_tag(:action_type, train_card_action_type(train_card)) %>
      <%= hidden_field_tag(:card_index, index) %>
      <%= submit_tag('Draw', class: "card #{train_card.color}") %>
    <% end %>
  <% end %>
</div>

<% if not playing_game? @game %>
    <%= link_to("Join Game", game_players_path(@game), method: :post) %>
<% end %>


<%= javascript_include_tag 'games_show.js' %>
